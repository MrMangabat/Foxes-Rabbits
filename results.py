import base64
eval(compile(base64.b64decode(b'IiIiClRoaXMgbW9kdWxlIG9mZmVycyBjbGFzc2VzIGZvciBzdG9yaW5nIGRhdGEgYW5kIHN0YXRpc3RpY3Mgb2YgYSBzaW11bGF0aW9uIHJ1bi4KIiIiCgpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdAoKY2xhc3MgUG9wdWxhdGlvblN0YXRzOgogICIiIgogIEEgY2xhc3MgZm9yIHN0b3JpbmcgdGhlIGRhdGEgYWJvdXQgYSBwb3B1bGF0aW9uIGNvbGxlY3RlZCBkdXJpbmcgYSBzaW11bGF0aW9uIHJ1bi4KICAiIiIKICAKICBfX3Nsb3RzX18gPSBbCiAgICAiX3NpemVzIiwKICAgICJfdG90YWwiLAogICAgIl9kZWFkX2J5X29sZF9hZ2UiLAogICAgIl9kZWFkX2J5X3N0YXJ2YXRpb24iLAogICAgIl9kZWFkX2J5X3ByZWRhdGlvbiIsCiAgICAiX2FnZV9hdF9kZWF0aCIsCiAgICAiX2F2Z19lbmVyZ3lfcGVyX3N0ZXAiCiAgXQoKICBkZWYgX19pbml0X18oc2VsZik6CiAgICBzZWxmLl9zaXplcyA9IFtdCiAgICBzZWxmLl90b3RhbCA9IDAKICAgIHNlbGYuX2RlYWRfYnlfb2xkX2FnZSA9IDAKICAgIHNlbGYuX2RlYWRfYnlfc3RhcnZhdGlvbiA9IDAKICAgIHNlbGYuX2RlYWRfYnlfcHJlZGF0aW9uID0gMAogICAgc2VsZi5fYWdlX2F0X2RlYXRoID0gW10KICAgIHNlbGYuX2F2Z19lbmVyZ3lfcGVyX3N0ZXAgPSBbXQoKICBAcHJvcGVydHkKICBkZWYgc2l6ZV9wZXJfc3RlcChzZWxmKSAtPiBMaXN0W2ludF06CiAgICAiIiIKICAgIEEgcmVjb3JkIG9mIHRoZSBzaXplIG9mIHRoZSAoYWxpdmUpIHBvcHVsYXRpb24sIGluIGNocm9ub2xvZ2ljYWwgb3JkZXIuCiAgICAiIiIKICAgIHJldHVybiBzZWxmLl9zaXplcwoKICBAc2l6ZV9wZXJfc3RlcC5zZXR0ZXIKICBkZWYgc2l6ZV9wZXJfc3RlcChzZWxmLHZhbHVlIDogTGlzdFtpbnRdKToKICAgIHNlbGYuX3NpemVzID0gdmFsdWUKCiAgQHByb3BlcnR5CiAgZGVmIHRvdGFsKHNlbGYpIC0+IGludDoKICAgICIiIgogICAgSW5kaXZpZHVhbHMgYWxpdmUgYW5kIGV2ZXIgbGl2ZWQuCiAgICAiIiIKICAgIHJldHVybiBzZWxmLl90b3RhbAoKICBAdG90YWwuc2V0dGVyCiAgZGVmIHRvdGFsKHNlbGYsdmFsdWUgOiBpbnQpOgogICAgc2VsZi5fdG90YWwgPSB2YWx1ZQoKICBAcHJvcGVydHkKICBkZWYgZGVhZF9ieV9vbGRfYWdlKHNlbGYpIC0+IGludDoKICAgICIiIgogICAgTnVtYmVyIG9mIGluZGl2aWR1YWxzIHRoYXQgZGllZCBieSBvbGQgYWdlLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fZGVhZF9ieV9vbGRfYWdlCgogIEBkZWFkX2J5X29sZF9hZ2Uuc2V0dGVyCiAgZGVmIGRlYWRfYnlfb2xkX2FnZShzZWxmLHZhbHVlIDogaW50KToKICAgIHNlbGYuX2RlYWRfYnlfb2xkX2FnZSA9IHZhbHVlCiAgCiAgQHByb3BlcnR5CiAgZGVmIGRlYWRfYnlfc3RhcnZhdGlvbihzZWxmKSAtPiBpbnQ6CiAgICAiIiIKICAgIE51bWJlciBvZiBpbmRpdmlkdWFscyB0aGF0IGRpZWQgYnkgc3RhcnZhdGlvbi4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2RlYWRfYnlfc3RhcnZhdGlvbgoKICBAZGVhZF9ieV9zdGFydmF0aW9uLnNldHRlcgogIGRlZiBkZWFkX2J5X3N0YXJ2YXRpb24oc2VsZix2YWx1ZSA6IGludCk6CiAgICBzZWxmLl9kZWFkX2J5X3N0YXJ2YXRpb24gPSB2YWx1ZQoKICBAcHJvcGVydHkKICBkZWYgZGVhZF9ieV9wcmVkYXRpb24oc2VsZikgLT4gaW50OgogICAgIiIiCiAgICBOdW1iZXIgb2YgaW5kaXZpZHVhbHMgdGhhdCBkaWVkIGJ5IHByZWRhdGlvbi4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2RlYWRfYnlfcHJlZGF0aW9uCgogIEBkZWFkX2J5X3ByZWRhdGlvbi5zZXR0ZXIKICBkZWYgZGVhZF9ieV9wcmVkYXRpb24oc2VsZix2YWx1ZSA6IGludCk6CiAgICBzZWxmLl9kZWFkX2J5X3ByZWRhdGlvbiA9IHZhbHVlCgogIEBwcm9wZXJ0eQogIGRlZiBhdmdfZW5lcmd5X3Blcl9zdGVwKHNlbGYpIC0+IExpc3RbZmxvYXRdOgogICAgIiIiCiAgICBBIHJlY29yZCBvZiB0aGUgYXZlcmFnZSBlbmVyZ3kgbGV2ZWwgYWNyb3NzIHRoZSBwb3B1bGF0aW9uLCBpbiBjaHJvbm9sb2dpY2FsIG9yZGVyLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fYXZnX2VuZXJneV9wZXJfc3RlcAoKICBAYXZnX2VuZXJneV9wZXJfc3RlcC5zZXR0ZXIKICBkZWYgYXZnX2VuZXJneV9wZXJfc3RlcChzZWxmLCB2YWx1ZSA6IExpc3RbZmxvYXRdKToKICAgIHNlbGYuX2F2Z19lbmVyZ3lfcGVyX3N0ZXAgPSB2YWx1ZQogIAogIEBwcm9wZXJ0eQogIGRlZiBhZ2VfYXRfZGVhdGgoc2VsZikgLT4gTGlzdFtpbnRdOgogICAgIiIiCiAgICBBIHJlY29yZCBvZiB0aGUgYWdlIG9mIGRlYXRoIG9mIGVhY2ggaW5kaXZpZHVhbC4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2FnZV9hdF9kZWF0aAogIAogIEBhZ2VfYXRfZGVhdGguc2V0dGVyCiAgZGVmIGFnZV9hdF9kZWF0aChzZWxmLHZhbHVlIDogTGlzdFtpbnRdKToKICAgIHNlbGYuX2FnZV9hdF9kZWF0aCA9IHZhbHVlCgpjbGFzcyBTaW11bGF0aW9uU3RhdHM6CiAgIiIiCiAgQSBjbGFzcyBmb3Igc3RvcmluZyB0aGUgZGF0YSBjb2xsZWN0ZWQgZHVyaW5nIGEgc2ltdWxhdGlvbiBydW4uCiAgIiIiCgogIF9fc2xvdHNfXyA9IFsKICAgICJfYXZnX2VuZXJneV9wZXJfc3RlcCIsCiAgICAiX2tpbGxzX3Blcl9wYXRjaCIsCiAgICAiX2ZveGVzIiwKICAgICJfcmFiYml0cyIsCiAgICAiX3N0ZXBzIgogIF0KCiAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgc2VsZi5fc3RlcHMgPSAwCiAgICBzZWxmLl9hdmdfZW5lcmd5X3Blcl9zdGVwID0gW10KICAgIHNlbGYuX2tpbGxzX3Blcl9wYXRjaCA9IFtdCiAgICBzZWxmLl9mb3hlcyA9IFBvcHVsYXRpb25TdGF0cygpCiAgICBzZWxmLl9yYWJiaXRzID0gUG9wdWxhdGlvblN0YXRzKCkKCiAgQHByb3BlcnR5CiAgZGVmIHN0ZXBzKHNlbGYpIC0+IGludDoKICAgICIiIgogICAgVGhlIG51bWJlciBvZiBzaW11bGF0aW9uIHN0ZXBzIHRoYXQgbGVhZCB0byB0aGUgY3VycmVudCBzdGF0ZSByZWNvcmRlZCBpbiB0aGlzIHN0YXRpc3RpY3MuCiAgICAiIiIKICAgIHJldHVybiBzZWxmLl9zdGVwcwoKICBAc3RlcHMuc2V0dGVyCiAgZGVmIHN0ZXBzKHNlbGYsdmFsdWUgOiBpbnQpOgogICAgc2VsZi5fc3RlcHMgPSB2YWx1ZQoKICBAcHJvcGVydHkKICBkZWYgZm94ZXMoc2VsZikgLT4gUG9wdWxhdGlvblN0YXRzOgogICAgIiIiCiAgICBTdGF0aXN0aWNzIGFib3V0IHRoZSBmb3ggcG9wdWxhdGlvbi4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2ZveGVzCgogIEBmb3hlcy5zZXR0ZXIKICBkZWYgZm94ZXMoc2VsZiwgdmFsdWUgOiBQb3B1bGF0aW9uU3RhdHMpOgogICAgc2VsZi5fZm94ZXMgPSB2YWx1ZQoKICBAcHJvcGVydHkKICBkZWYgcmFiYml0cyhzZWxmKSAtPiBQb3B1bGF0aW9uU3RhdHM6CiAgICAiIiIKICAgIFN0YXRpc3RpY3MgYWJvdXQgdGhlIHJhYmJpdCBwb3B1bGF0aW9uLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fcmFiYml0cwoKICBAcmFiYml0cy5zZXR0ZXIKICBkZWYgcmFiYml0cyhzZWxmLCB2YWx1ZSA6IFBvcHVsYXRpb25TdGF0cyk6CiAgICBzZWxmLl9yYWJiaXRzID0gdmFsdWUKCiAgQHByb3BlcnR5CiAgZGVmIGF2Z19lbmVyZ3lfcGVyX3N0ZXAoc2VsZikgLT4gTGlzdFtmbG9hdF06CiAgICAiIiIKICAgIEEgcmVjb3JkIG9mIHRoZSBhdmVyYWdlIGVuZXJneSBsZXZlbCBhY3Jvc3MgYWxsIHBvcHVsYXRpb25zLCBpbiBjaHJvbm9sb2dpY2FsIG9yZGVyLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fYXZnX2VuZXJneV9wZXJfc3RlcAoKICBAYXZnX2VuZXJneV9wZXJfc3RlcC5zZXR0ZXIKICBkZWYgYXZnX2VuZXJneV9wZXJfc3RlcChzZWxmLCB2YWx1ZSA6IExpc3RbZmxvYXRdKToKICAgIHNlbGYuX2F2Z19lbmVyZ3lfcGVyX3N0ZXAgPSB2YWx1ZQoKICBAcHJvcGVydHkKICBkZWYga2lsbHNfcGVyX3BhdGNoKHNlbGYpIC0+IExpc3RbTGlzdFtpbnRdXToKICAgICIiIgogICAgQSBncmlkIGNvbnRhaW5pbmcgdGhlIHRvdGFsIG9mIGRlYXRocyBieSBwcmVkYXRpb24gcGVyIGV2ZXJ5IHBhdGNoIGluIHRoZSBzaW11bGF0aW9uLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fa2lsbHNfcGVyX3BhdGNoCiAgCiAgQGtpbGxzX3Blcl9wYXRjaC5zZXR0ZXIKICBkZWYga2lsbHNfcGVyX3BhdGNoKHNlbGYsdmFsdWUgOiBMaXN0W0xpc3RbaW50XV0pOgogICAgc2VsZi5fa2lsbHNfcGVyX3BhdGNoID0gdmFsdWUK'),'<string>','exec'))