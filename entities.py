import base64
eval(compile(base64.b64decode(b'aW1wb3J0IHBhcmFtZXRlcnMKaW1wb3J0IHJhbmRvbQoKZnJvbSB0eXBpbmcgaW1wb3J0IFR1cGxlLCBPcHRpb25hbAoKY2xhc3MgUGF0Y2g6CiAgIiIiCiAgQSBwYXRjaCBvZiBncmFzcyBhdCBhIGdpdmVuIHBhaXIgb2YgY29vcmRpbmF0ZXMuCgogIEluaXRpYWxpc2F0aW9uOiBQYXRjaCggbm9ydGhfc291dGhfcG9zaXRpb24sIHdlc3RfZWFzdF9wb3NpdGlvbiApCiAgIiIiCiAgCgogIF9fc2xvdHNfXyA9IFsKICAgICJfZ3Jhc3MiLAogICAgIl9jb29yZGluYXRlcyIsCiAgICAiX2ZveGVzIiwKICAgICJfcmFiYml0cyIKICBdCiAgCiAgbWluX2dyYXNzX2dyb3d0aCA9IDEKICBtYXhfZ3Jhc3NfZ3Jvd3RoID0gNAogIG1heF9ncmFzc19hbW91bnQgPSAzMAoKICBkZWYgX19pbml0X18oc2VsZiwgeCA6IGludCwgeTppbnQpOgogICAgc2VsZi5fY29vcmRpbmF0ZXMgPSAoeCx5KQogICAgc2VsZi5fZ3Jhc3MgPSByYW5kb20ucmFuZHJhbmdlKHJvdW5kKFBhdGNoLm1heF9ncmFzc19hbW91bnQgKiAwLjMpLFBhdGNoLm1heF9ncmFzc19hbW91bnQpCiAgICBzZWxmLl9mb3hlcyA9IFtdCiAgICBzZWxmLl9yYWJiaXRzID0gW10KICAKICBkZWYgdGljayhzZWxmKToKICAgICIiIgogICAgUmVjb3JkcyB0aGUgcGFzc2FnZSBvZiB0aW1lIChvbmUgc3RlcCBpbiB0aGUgc2ltdWxhdGlvbikgYW5kIGdyb3dzIGdyYXNzLgogICAgIiIiCiAgICBpZiBzZWxmLl9ncmFzcyA8IFBhdGNoLm1heF9ncmFzc19hbW91bnQ6CiAgICAgIGcgPSBzZWxmLl9ncmFzcyArIHJhbmRvbS5yYW5kcmFuZ2UoUGF0Y2gubWluX2dyYXNzX2dyb3d0aCxQYXRjaC5tYXhfZ3Jhc3NfZ3Jvd3RoKQogICAgICBzZWxmLl9ncmFzcyA9IG1pbihnLCBQYXRjaC5tYXhfZ3Jhc3NfYW1vdW50KQoKICBkZWYgZ3Jhc3Moc2VsZikgLT4gaW50OgogICAgIiIiCiAgICBSZXR1cm5zIHRoZSBhbW91bnQgb2YgZ3Jhc3MgaW4gdGhpcyBwYXRjaC4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2dyYXNzCgogIGRlZiBjb29yZGluYXRlcyhzZWxmKSAtPiBUdXBsZVtpbnQsaW50XToKICAgICIiIgogICAgUmV0dXJucyB0aGUgY29vcmRpbmF0ZXMgaW4gdGhlIHNpbXVsYXRlZCB3b3JsZCBmb3IgdGhpcyBwYXRjaC4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2Nvb3JkaW5hdGVzCgogIGRlZiBfcG9wdWxhdGlvbihzZWxmLGFuaW1hbCk6CiAgICBpZiB0eXBlKGFuaW1hbCkgaXMgRm94OgogICAgICByZXR1cm4gc2VsZi5fZm94ZXMKICAgIGVsc2U6CiAgICAgIHJldHVybiBzZWxmLl9yYWJiaXRzCiAgCiAgZGVmIF9oYXNfYWxpdmVfZm94KHNlbGYpIC0+IGJvb2w6CiAgICBmb3IgYSBpbiBzZWxmLl9mb3hlczoKICAgICAgaWYgYS5pc19hbGl2ZSgpOgogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCiAgZGVmIF9oYXNfYWxpdmVfcmFiYml0KHNlbGYpIC0+IGJvb2w6CiAgICBmb3IgYSBpbiBzZWxmLl9yYWJiaXRzOgogICAgICBpZiBhLmlzX2FsaXZlKCk6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQogIAogIGRlZiBfZ2V0X2FsaXZlX3JhYmJpdChzZWxmKSAtPiBPcHRpb25hbFsnUmFiYml0J106CiAgICBmb3IgYSBpbiBzZWxmLl9yYWJiaXRzOgogICAgICBpZiBhLmlzX2FsaXZlKCk6CiAgICAgICAgcmV0dXJuIGEKICAgIHJldHVybiBOb25lCgogIGRlZiBhZGQoc2VsZixhbmltYWwpOgogICAgc2VsZi5fcG9wdWxhdGlvbihhbmltYWwpLmFwcGVuZChhbmltYWwpCgogIGRlZiByZW1vdmUoc2VsZixhbmltYWwpOgogICAgc2VsZi5fcG9wdWxhdGlvbihhbmltYWwpLnJlbW92ZShhbmltYWwpCgogIGRlZiBhbmltYWxzKHNlbGYpOgogICAgIiIiCiAgICBSZXR1cm5zIGEgbGlzdCBjb250YWluaW5nIHRoZSBhbmltYWxzIG9uIHRoZSBwYXRjaC4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX3JhYmJpdHMgKyBzZWxmLl9mb3hlcwoKCmNsYXNzIEFuaW1hbDoKCiAgX19zbG90c19fID0gWwogICAgIl9wYXJhbXMiLAogICAgIl9lbmVyZ3kiLAogICAgIl9hZ2UiLAogICAgIl9wYXRjaCIKICAgIF0KCiAgZGVmIF9faW5pdF9fKHNlbGYsIHBvcHVsYXRpb24gOiBwYXJhbWV0ZXJzLlBvcHVsYXRpb24sIAogICAgICAgICAgICAgICBwYXRjaCA6IFBhdGNoLCBlbmVyZ3kgOiBpbnQsIGFnZSA6IGludCk6CiAgICBhc3NlcnQgMCA8PSBhZ2UgPD0gcG9wdWxhdGlvbi5tYXhfYWdlCiAgICBhc3NlcnQgMCA8PSBlbmVyZ3kgPD0gcG9wdWxhdGlvbi5tYXhfZW5lcmd5CiAgICBzZWxmLl9wYXJhbXMgPSBwb3B1bGF0aW9uCiAgICBzZWxmLl9lbmVyZ3kgPSBlbmVyZ3kKICAgIHNlbGYuX2FnZSA9IGFnZQogICAgc2VsZi5fcGF0Y2ggPSBwYXRjaAogICAgc2VsZi5fcGF0Y2guYWRkKHNlbGYpCgogIGRlZiBpc19hbGl2ZShzZWxmKSAtPiBib29sOgogICAgIiIiCiAgICBSZXR1cm5zIFRydWUgaWYgdGhlIGFuaW1hbCBpcyBhbGl2ZSwgRmFsc2Ugb3RoZXJ3aXNlLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fZW5lcmd5ID4gMCBhbmQgc2VsZi5fYWdlIDwgc2VsZi5fcGFyYW1zLm1heF9hZ2UKCiAgZGVmIHBhdGNoKHNlbGYpIC0+IFBhdGNoOgogICAgIiIiCiAgICBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiB0aGUgYW5pbWFsLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fcGF0Y2gKCiAgZGVmIGFnZShzZWxmKSAtPiBpbnQ6CiAgICAiIiIKICAgIFJldHVybnMgdGhlIGFnZSBvZiB0aGUgYW5pbWFsLgogICAgIiIiCiAgICByZXR1cm4gc2VsZi5fYWdlCgogIGRlZiBlbmVyZ3koc2VsZikgLT4gaW50OgogICAgIiIiCiAgICBSZXR1cm5zIHRoZSBlbmVyZ3kgb2YgdGhlIGFuaW1hbC4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuX2VuZXJneQoKICBkZWYgc2FtZV9zcGVjaWVzX2luKHNlbGYsIHBhdGNoIDogUGF0Y2gpIC0+IGJvb2w6CiAgICAiIiIKICAgIFJldHVybiBUcnVlIGlmIHRoZSBnaXZlbiBwYXRjaCBjb250YWlucyBhbiAoYWxpdmUpIGFuaW1hbCBvZiB0aGUgc2FtZSBzcGVjaWVzLgogICAgIiIiCiAgICBwYXNzCgogIGRlZiBwcmVkYXRvcnNfaW4oc2VsZixwYXRjaCA6IFBhdGNoKSAtPiBib29sOgogICAgIiIiCiAgICBSZXR1cm5zIFRydWUgaWYgdGhlIGdpdmVuIHBhdGNoIGNvbnRhaW5zIGFuIGFsaXZlIHByZWRhdG9yIG9mIHRoaXMgYW5pbWFsLgogICAgIiIiCiAgICBwYXNzCiAgCiAgZGVmIHRpY2soc2VsZik6CiAgICAiIiIKICAgIFJlY29yZHMgdGhlIHBhc3NhZ2Ugb2YgdGltZSAob25lIHN0ZXAgaW4gdGhlIHNpbXVsYXRpb24pLiBUaGUgYW5pbWFsIGFnZXMKICAgIGFuZCBjb25zdW1lcyBlbmVyZ3kuCiAgICAiIiIKICAgIGlmIHNlbGYuaXNfYWxpdmUoKToKICAgICAgc2VsZi5fZW5lcmd5ID0gbWF4KDAsc2VsZi5fZW5lcmd5IC0gc2VsZi5fcGFyYW1zLm1ldGFib2xpc20pCiAgICAgIHNlbGYuX2FnZSArPSAxCiAgICAgIGlmIG5vdCBzZWxmLmlzX2FsaXZlKCk6CiAgICAgICAgc2VsZi5fcGF0Y2gucmVtb3ZlKHNlbGYpCgogIGRlZiBmZWVkKHNlbGYpOgogICAgIiIiCiAgICBGZWVkcyBpdHNlbGYgdXNpbmcgdGhlIHJlc291cmNlcyBhdCBpdHMgY3VycmVudCBsb2NhdGlvbi4KICAgICIiIgogICAgcGFzcwoKICBkZWYgY2FuX3JlcHJvZHVjZShzZWxmKSAtPiBib29sOgogICAgIiIiCiAgICBSZXR1cm5zIFRydWUgaWYgdGhlIGFuaW1hbCBpcyBvbGQgZW5vdWdoIGFuZCBoYXMgZW5vdWdoIGVuZXJneSB0byByZXByb2R1Y2UsIEZhbHNlIG90aGVyd2lzZS4KICAgICIiIgogICAgcmV0dXJuIHNlbGYuaXNfYWxpdmUoKSBhbmQgXAogICAgICBzZWxmLmVuZXJneSgpID49IHNlbGYuX3BhcmFtcy5yZXByb2R1Y3Rpb25fbWluX2VuZXJneSBhbmQgXAogICAgICBzZWxmLmFnZSgpID49IHNlbGYuX3BhcmFtcy5yZXByb2R1Y3Rpb25fbWluX2FnZQoKICBkZWYgcmVwcm9kdWNlKHNlbGYsIHBhdGNoIDogUGF0Y2gpIC0+IE9wdGlvbmFsWydBbmltYWwnXToKICAgICIiIgogICAgUmV0dXJucyBhbiBpbnN0YW5jZSBmb3IgdGhlIG5ld2Jvcm4gb3IgTm9uZS4KICAgICIiIgogICAgcmV0dXJuIE5vbmUKCiAgZGVmIF9yZXByb2R1Y2Uoc2VsZixzcGVjaWVzLHBhdGNoKToKICAgIGlmIHNlbGYuY2FuX3JlcHJvZHVjZSgpIGFuZCBcCiAgICAgIHJhbmRvbS5yYW5kb20oKSA8IHNlbGYuX3BhcmFtcy5yZXByb2R1Y3Rpb25fcHJvYmFiaWxpdHk6CiAgICAgIHNlbGYuX2VuZXJneSAtPSByb3VuZChzZWxmLl9wYXJhbXMucmVwcm9kdWN0aW9uX21pbl9lbmVyZ3kgKiBzcGVjaWVzLnJlcHJvZHVjdGlvbl9jb3N0X3JhdGUpCiAgICAgIHJldHVybiBzcGVjaWVzKHNlbGYuX3BhcmFtcywgcGF0Y2gsIDApCiAgICBlbHNlOgogICAgICByZXR1cm4gTm9uZQoKICBkZWYgbW92ZV90byhzZWxmLCBwYXRjaCA6IFBhdGNoKToKICAgICIiIgogICAgVGhlIGFuaW1hbCBnb2VzIGZyb20gaXRzIGN1cnJlbnQgcGF0Y2ggdG8gdGhlIGdpdmVuIG9uZS4KICAgICIiIgogICAgYXNzZXJ0IHNlbGYuaXNfYWxpdmUoKQogICAgYXNzZXJ0IHNlbGYucGF0Y2goKSAhPSBwYXRjaAogICAgYXNzZXJ0IG5vdCBzZWxmLnNhbWVfc3BlY2llc19pbihwYXRjaCkKICAgIHNlbGYuX3BhdGNoLnJlbW92ZShzZWxmKQogICAgc2VsZi5fcGF0Y2ggPSBwYXRjaAogICAgc2VsZi5fcGF0Y2guYWRkKHNlbGYpCgpjbGFzcyBGb3goQW5pbWFsKToKCiAgZGVmIF9faW5pdF9fKHNlbGYsIHBvcHVsYXRpb24gOiBwYXJhbWV0ZXJzLlBvcHVsYXRpb24sIAogICAgICAgICAgICAgICBwYXRjaCA6IFBhdGNoLCBhZ2UgOiBpbnQpOgogICAgCiAgICBlbmVyZ3kgPSByb3VuZChwb3B1bGF0aW9uLm1heF9lbmVyZ3kgKiAwLjcpCiAgICBzdXBlcigpLl9faW5pdF9fKHBvcHVsYXRpb24scGF0Y2gsZW5lcmd5LGFnZSkKCiAgZGVmIHNhbWVfc3BlY2llc19pbihzZWxmLCBwYXRjaCA6IFBhdGNoKSAtPiBib29sOgogICAgcmV0dXJuIHBhdGNoLl9oYXNfYWxpdmVfZm94KCkKCiAgZGVmIHByZWRhdG9yc19pbihzZWxmLHBhdGNoIDogUGF0Y2gpIC0+IGJvb2w6CiAgICByZXR1cm4gRmFsc2UKCiAgcmVwcm9kdWN0aW9uX2Nvc3RfcmF0ZSA9IDAuODUKCiAgZGVmIHJlcHJvZHVjZShzZWxmLCBwYXRjaCA6IFBhdGNoKToKICAgIHJldHVybiBzZWxmLl9yZXByb2R1Y2UoRm94LHBhdGNoKQoKICBmb29kX2VuZXJneV9wZXJfdW5pdCA9IDE1CgogIGRlZiBmZWVkKHNlbGYpOgogICAgaWYgc2VsZi5pc19hbGl2ZSgpIGFuZCBcCiAgICAgIHNlbGYuX2VuZXJneSA8IHNlbGYuX3BhcmFtcy5tYXhfZW5lcmd5IC0gMTA6CiAgICAgIHIgPSBzZWxmLl9wYXRjaC5fZ2V0X2FsaXZlX3JhYmJpdCgpCiAgICAgIGlmIHI6CiAgICAgICAgci5raWxsKCkKICAgICAgICBzZWxmLl9lbmVyZ3kgPSBtaW4oIHNlbGYuX2VuZXJneSArIEZveC5mb29kX2VuZXJneV9wZXJfdW5pdCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9wYXJhbXMubWF4X2VuZXJneSkKCmNsYXNzIFJhYmJpdChBbmltYWwpOgoKICBfX3Nsb3RzX18gPSBbCiAgICAiX2tpbGxlZCIKICBdCgogIGRlZiBfX2luaXRfXyhzZWxmLCBwb3B1bGF0aW9uIDogcGFyYW1ldGVycy5Qb3B1bGF0aW9uLCAKICAgICAgICAgICAgICAgcGF0Y2ggOiBQYXRjaCwgYWdlIDogaW50KToKICAgIGVuZXJneSA9IHJvdW5kKHBvcHVsYXRpb24ubWF4X2VuZXJneSAqIDAuMjUpCiAgICBzdXBlcigpLl9faW5pdF9fKHBvcHVsYXRpb24scGF0Y2gsZW5lcmd5LGFnZSkKICAgIHNlbGYuX2tpbGxlZCA9IEZhbHNlCgogIGRlZiBpc19hbGl2ZShzZWxmKSAtPiBib29sOgogICAgcmV0dXJuIG5vdCBzZWxmLl9raWxsZWQgYW5kIHN1cGVyKCkuaXNfYWxpdmUoKQoKICBkZWYgd2FzX2tpbGxlZChzZWxmKSAtPiBib29sOgogICAgcmV0dXJuIHNlbGYuX2tpbGxlZAoKICBkZWYga2lsbChzZWxmKToKICAgICIiIgogICAgS2lsbCB0aGlzIHJhYmJpdC4KICAgICIiIgogICAgc2VsZi5fa2lsbGVkID0gVHJ1ZQogICAgc2VsZi5fcGF0Y2gucmVtb3ZlKHNlbGYpCgogIGRlZiBzYW1lX3NwZWNpZXNfaW4oc2VsZiwgcGF0Y2ggOiBQYXRjaCkgLT4gYm9vbDogICAgCiAgICByZXR1cm4gcGF0Y2guX2hhc19hbGl2ZV9yYWJiaXQoKQoKICBkZWYgcHJlZGF0b3JzX2luKHNlbGYsIHBhdGNoIDogUGF0Y2gpIC0+IGJvb2w6CiAgICByZXR1cm4gcGF0Y2guX2hhc19hbGl2ZV9mb3goKQoKICByZXByb2R1Y3Rpb25fY29zdF9yYXRlID0gMC45CgogIGRlZiByZXByb2R1Y2Uoc2VsZiwgcGF0Y2gpOgogICAgcmV0dXJuIHNlbGYuX3JlcHJvZHVjZShSYWJiaXQscGF0Y2gpCiAgCiAgZmVlZGluZ19tZXRhYm9saXNtX3JhdGUgPSAyLjUKCiAgZGVmIGZlZWQoc2VsZik6CiAgICBpZiBzZWxmLmlzX2FsaXZlKCk6CiAgICAgIGQgPSBzZWxmLl9wYXJhbXMubWF4X2VuZXJneSAtIHNlbGYuX2VuZXJneQogICAgICBtID0gcm91bmQoc2VsZi5fcGFyYW1zLm1ldGFib2xpc20gKiBSYWJiaXQuZmVlZGluZ19tZXRhYm9saXNtX3JhdGUpCiAgICAgIHggPSBtaW4oc2VsZi5fcGF0Y2guZ3Jhc3MoKSwgbSwgZCApCiAgICAgIGlmIHg6CiAgICAgICAgc2VsZi5fcGF0Y2guX2dyYXNzIC09IHgKICAgICAgICBzZWxmLl9lbmVyZ3kgKz0geAo='),'<string>','exec'))